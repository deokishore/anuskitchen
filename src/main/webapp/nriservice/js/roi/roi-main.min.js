!function(e){e(document).ready(function(){function s(){var s=e(".slide-window").width(),t=e(".slide");t.width(s)}function t(s){var t=s.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");return t.length>=8&&t.length<=9?e(".big-result").css("font-size","4rem"):t.length>9&&e(".big-result").css("font-size","3.5rem"),t}function r(s){function t(){e(".slide-holder").animate({left:"-"+c},400),window.matchMedia("(min-width: 640px)").matches&&e("html, body").animate({scrollTop:e(".banner").height()+e("header").height()},800)}function r(e){var s=document.getElementById("progress-bar");s.style.width=(e-1)*(100/a)+"%"}"backward"==s?n>1&&n--:"forward"==s&&a>=n&&n++;var i=(e(".slide-holder").width(),e(".slide").width()),c=i*(n-1);a>=n&&(e("#page_numerator").text(n),t()),1==n?e(".btn_prev").hide():e(".btn_prev").show(),8==n?e(".btn_prev").hide():e(".btn_prev").show(),n>a-1?(e(".btn_next").hide(),e(".submit-roi").show()):e(".submit-roi").hide(),n>a?e(".submit-roi").click():e(".bottom-container").hide(),r(n),l(n),o(n),console.log(n),n>7?mktoMunchkinFunction("visitWebPage",{url:"/vpv/roi-calculator/results-slide"}):mktoMunchkinFunction("visitWebPage",{url:"/vpv/roi-calculator/slide"+n})}var a=e(".slide-holder").children().length;console.log(a);var n=1;window.location.pathname.indexOf("results")<0&&e('input[type="text"]')[0].focus(),window.resultsObj={},1==n?e(".btn_prev").css("display","none"):e(".btn_prev").css("display","block"),s(),e(window).on("resize",s).resize();var l=function(s){if(window.matchMedia("(max-width: 640px)").matches)var t=e(".slide1").height(),r=e(".slide2").height(),a=e(".slide3").height(),n=e(".slide4").height(),l=e(".slide5").height(),i=e(".slide6").height(),o=e(".slide7").height();else var t=e(".slide1").height()+62,r=e(".slide2").height(),a=e(".slide3").height(),n=e(".slide4").height()+100,l=e(".slide5").height(),i=e(".slide6").height()+87,o=e(".slide7").height();console.log(s),"1"==s?e(".slide-window").height(t):"2"==s?e(".slide-window").height(r):"3"==s?e(".slide-window").height(a):"4"==s?e(".slide-window").height(n):"5"==s?e(".slide-window").height(l):"6"==s?e(".slide-window").height(i):"7"==s&&e(".slide-window").height(o)};1==n&&l(n),e(".btn_prev").on("click",function(e){e.preventDefault();var s="backward";r(s),_gas.push(["_trackEvent","ROI Calculator","Click","Previous Button"])}),e(".btn_next").on("click",function(e){var s="forward",t=i(n);t&&r(s)}),e(".submit-roi").on("click",function(s){s.preventDefault(),resultsObj.step=7,resultsObj.avg_amount_per_sale=e("#avg_amount_per_sale").val().replace(/[^0-9\.]/g,""),resultsObj.calc_sales_increase_amount=(parseInt(resultsObj.avg_amount_per_sale,10)*parseInt(resultsObj.calc_sales_increase_count,10)).toFixed(0);var r=t(resultsObj.calc_sales_increase_amount);e(".calc_sales_increase_amount").text(r),e('input[name="calc_sales_increase_amount"]').val(r),resultsObj.calc_current_conv_rate=(parseInt(resultsObj.closed_leads,10)/parseInt(resultsObj.leads_per_month,10)*100).toFixed(2),e('input[name="calc_current_conv_rate"]').val(resultsObj.calc_current_conv_rate),resultsObj.calc_current_monthly_revenue=(parseInt(resultsObj.avg_amount_per_sale,10)*parseInt(resultsObj.closed_leads,10)).toFixed(2),e('input[name="calc_current_monthly_revenue"]').val(resultsObj.calc_current_monthly_revenue),resultsObj.calc_incr_revenue_perc=(parseInt(resultsObj.calc_sales_increase_amount,10)/parseInt(resultsObj.calc_current_monthly_revenue,10)*100).toFixed(2),resultsObj.completed=!0,e('input[name="resultsObj"]').val(JSON.stringify(resultsObj)),e('input[name="calc_incr_revenue_perc"]').val(resultsObj.calc_incr_revenue_perc),console.log(resultsObj.calc_missed_opp_perc+" and "+resultsObj.calc_current_conv_rate);var a=i(7);a&&e('form[name="roi_form"]').submit()}),e("#leads_per_month, #closed_leads, #sales_increase_perc, #avg_amount_per_sale").on({keydown:function(e){var s=e.which||e.keyCode;9==s&&e.preventDefault(),13==s&&e.preventDefault()},keyup:function(s){s.preventDefault();var t=s.which||s.keyCode;13==t&&e(".btn_next").click()}}),e("#email_field").on("keyup",function(s){s.preventDefault();var t=s.which||s.keyCode;13==t&&e("#email_submit").click()}),e("#lead_EmailPrefSmallBizTipsTricks").on("click",function(e){this.checked&&_gas.push(["_trackEvent","ROI Calculator","Click","Opt-In"])});var i=function(s){var t=e("#leads_per_month").val().replace(/[\$,\%]/g,""),r=e("#closed_leads").val().replace(/[\$,\%]/g,""),a=e("#sales_increase_perc").val().replace(/[\$,\%]/g,""),n=e("#avg_amount_per_sale").val().replace(/[\$,\%]/g,"");return 1===s?isNaN(t)||""==t?(e("#error_message1").text("You need to enter a number before continuing."),e("#leads_per_month").focus(),!1):(e("#error_message1").text(""),!0):2!==s?5===s?isNaN(a)||""==a?(e("#error_message3").text("You need to enter a number before continuing"),e("#sales_increase_perc").focus(),!1):(e("#error_message3").text(""),!0):7===s?isNaN(n)||""==n?(e("#error_message4").text("You need to enter a number before continuing"),e("#avg_amount_per_sale").focus(),!1):(e("#error_message4").text(""),!0):(e("#error_message1, #error_message2, #error_message3, #error_message4").text(""),!0):isNaN(r)||""==r?(e("#error_message2").text("You need to enter a number before continuing"),e("#closed_leads").focus(),!1):($leadsPerMonthInt=parseInt(t,10),$closedLeadsInt=parseInt(r,10),$leadsPerMonthInt>$closedLeadsInt?(e("#error_message2").text(""),!0):void e("#error_message2").text("This number should be smaller than your leads per month."))};e("#mktoEmailForm").validate({rules:{Email:{required:!0,email:!0}},submitHandler:function(e){e.submit()}}),e.fn.setCursorPosition=function(e){return this.each(function(s,t){if(t.setSelectionRange)t.setSelectionRange(e,e);else if(t.createTextRange){var r=t.createTextRange();r.collapse(!0),r.moveEnd("character",e),r.moveStart("character",e),r.select()}}),this},e("#sales_increase_perc").on("keyup",function(s){var t=s.which||s.keyCode;if(8!=t&&13!=t&&37!=t&&39!=t){var r=e("#sales_increase_perc").val().length,a=e("#sales_increase_perc").val(),n=a.replace("%","");e("#sales_increase_perc").val(n+"%"),r>1?e("#sales_increase_perc").setCursorPosition(r-1):e("#sales_increase_perc").setCursorPosition(r)}}),e("#avg_amount_per_sale").on("keyup",function(s){var t=s.which||s.keyCode;if(8!=t&&13!=t&&37!=t&&39!=t){var r=e("#avg_amount_per_sale").val(),a=r.replace("$","");e("#avg_amount_per_sale").val("$"+a)}});var o=function(s){var r=s-1,a=!0;if(0==r&&e(".roi-master-text").text("IN AN AVERAGE MONTH, HOW MANY LEADS DOES YOUR COMPANY ATTRACT?"),1==r)e(".roi-master-text").text("OF THOSE LEADS, HOW MANY CHOOSE TO BUY FROM YOU RIGHT AWAY?"),resultsObj.step=1,resultsObj.leads_per_month=e("#leads_per_month").val().replace(/[^0-9\.]/g,""),setTimeout(function(){e("#closed_leads").focus()},800),console.log(resultsObj.leads_per_month);else if(2==r){resultsObj.step=2,e(".roi-master-text").text("WHEN IT COMES TO MAKING A SALE, TIMING IS EVERYTHING"),resultsObj.closed_leads=e("#closed_leads").val().replace(/[^0-9\.]/g,""),console.log(resultsObj.closed_leads),resultsObj.calc_missed_opp_count=parseInt(resultsObj.leads_per_month,10)-parseInt(resultsObj.closed_leads,10);var n=t(resultsObj.calc_missed_opp_count);e(".calc_missed_opp_count").text(n),e('input[name="calc_missed_opp_count"]').val(n),resultsObj.calc_missed_opp_perc=(parseInt(resultsObj.calc_missed_opp_count,10)/parseInt(resultsObj.leads_per_month,10)*100).toFixed(1);var l=t(resultsObj.calc_missed_opp_perc);e(".calc_current_conv_rate").text(l)}else if(3==r)e(".roi-master-text").text("Sales and marketing automation"),resultsObj.step=3,a=!1;else if(4==r)resultsObj.step=4,e(".roi-master-text").text("WHAT PERCENTAGE DO YOU THINK WOULD EVENTUALLY BUY FROM YOU?"),a=!1,setTimeout(function(){e("#sales_increase_perc").focus()},800);else if(5==r){resultsObj.step=5,e(".roi-master-text").text("based on your estimated conversion rate"),resultsObj.sales_increase_perc=e("#sales_increase_perc").val().replace(/[^0-9\.]/g,""),resultsObj.calc_sales_increase_count=(parseInt(resultsObj.calc_missed_opp_count,10)*parseInt(resultsObj.sales_increase_perc,10)*.01).toFixed(0);var i=t(resultsObj.calc_sales_increase_count);e(".calc_sales_increase_count").text(i),e('input[name="calc_sales_increase_count"]').val(i)}else 6==r&&(e(".roi-master-text").text("How much revenue would one new customer mean for your business this month?"),resultsObj.step=6,a=!1,setTimeout(function(){e("#avg_amount_per_sale").focus()},800));if(a){var o=e.ajax({url:"http://analysis.infusionsoft.com/mkto/is_ROIcalc.php",dataType:"jsonp",jsonpCallback:"callBackSilly",type:"post",data:{info:JSON.stringify(resultsObj)}});o.done(function(e){console.log("success",e)}),o.fail(function(e){console.log("fail",e)})}e("#lead_RoiCalcResults").val(JSON.stringify(resultsObj))}})}(jQuery);